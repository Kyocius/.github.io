<!DOCTYPE html>
<html><head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Noto+Serif+SC&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<title>写给 C# 开发者的 F# 光速入门教程</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="Guide for C# devs to learn F# real FAST">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="写给 C# 开发者的 F# 光速入门教程" />
<meta property="og:description" content="Guide for C# devs to learn F# real FAST" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kyocius.github.io/posts/dotnet/fsharp-for-csharp-devs/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-08-26T00:00:00+00:00" /><meta property="og:site_name" content="My Blog" />





<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="写给 C# 开发者的 F# 光速入门教程"/>
<meta name="twitter:description" content="Guide for C# devs to learn F# real FAST"/>









<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "abcdefghzd");
</script>



  






      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.57be1a01cabcfbbbf049c73d743fb38d75407765dd90332ad99a7e28ea4593df.css" integrity="sha256-V74aAcq8&#43;7vwScc9dD&#43;zjXVAd2XdkDMq2Zp&#43;KOpFk98=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    歸檔 Archive
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    分類 Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    標簽 Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about/">
                    關於 About
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    訂閱 RSS
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目錄 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%be%8b-1%e5%9f%ba%e6%9c%ac%e5%87%bd%e6%95%b0%e5%a3%b0%e6%98%8e%e4%b8%8e%e5%ae%9e%e7%8e%b0" class="nav-例-1基本函数声明与实现">
									例 1：基本函数声明与实现
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-2%e5%9f%ba%e6%9c%ac%e5%85%b3%e9%94%ae%e5%ad%97%e5%92%8c%e6%93%8d%e4%bd%9c%e7%ac%a6" class="nav-例-2基本关键字和操作符">
									例 2：基本关键字和操作符
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-3%e5%9f%ba%e7%a1%80%e9%9b%86%e5%90%88" class="nav-例-3基础集合">
									例 3：基础集合
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-4%e4%bb%a3%e7%a0%81%e5%9d%97" class="nav-例-4代码块">
									例 4：代码块
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-5%e9%81%bf%e5%85%8d-null-%e5%92%8c%e5%bf%bd%e7%95%a5" class="nav-例-5避免-null-和忽略">
									例 5：避免 Null 和忽略
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-6%e7%b1%bb%e5%9e%8b" class="nav-例-6类型">
									例 6：类型
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-7%e5%87%bd%e6%95%b0%e7%9a%84%e9%a1%ba%e5%ba%8f%e5%be%88%e9%87%8d%e8%a6%81%e5%be%aa%e7%8e%af%e4%be%9d%e8%b5%96%e6%98%af%e4%b8%87%e6%81%b6%e4%b9%8b%e6%ba%90" class="nav-例-7函数的顺序很重要循环依赖是万恶之源">
									例 7：函数的顺序很重要，循环依赖是万恶之源
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-8%e5%a7%94%e6%89%98%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0%e6%88%91%e7%9a%84%e8%80%81%e5%a4%a9%e7%88%b7" class="nav-例-8委托匿名函数我的老天爷">
									例 8：委托、匿名函数···我的老天爷！
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-9%e5%85%83%e7%bb%84%e5%b1%80%e9%83%a8%e5%ba%94%e7%94%a8%e4%bb%a5%e5%8f%8a%e6%9f%af%e9%87%8c%e5%8c%96" class="nav-例-9元组局部应用以及柯里化">
									例 9：元组、局部应用以及柯里化
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-10%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%8f%92%e5%80%bc" class="nav-例-10字符串插值">
									例 10：字符串插值
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-11%e5%bc%82%e6%ad%a5%e4%bb%a3%e7%a0%81" class="nav-例-11异步代码">
									例 11：异步代码
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-12%e7%bc%96%e5%86%99%e6%9b%b4%e5%b0%91%e7%ac%a6%e5%8f%b7%e6%8f%90%e5%8d%87-f-%e8%84%9a%e6%9c%ac%e7%9a%84%e5%8f%af%e9%98%85%e8%af%bb%e6%80%a7" class="nav-例-12编写更少符号提升-f-脚本的可阅读性">
									例 12：编写更少符号，提升 F# 脚本的可阅读性！
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://kyocius.github.io/">
            游尔曼斯克
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://kyocius.github.io/">
        <div class="single-column-header-title">游尔曼斯克</div>
        
        <div class="single-column-header-subtitle">Kyocius &#43;</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    写给 C# 开发者的 F# 光速入门教程
                    
                    <div class="post-subtitle">
                        Guide for C# devs to learn F# real FAST
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-08-26 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/">[编程]</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/fsharp-basic">FSharp Basic</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <blockquote>
<p>本文翻译自托管在 GitHub 上的 <a href="https://github.com/knocte/2fsharp">2fsharp</a> 开源项目</p>
<p>译版仅发表在知乎和 <a href="https://yoroion.github.io">本人博客</a> 上，未经授权<strong>禁止转载</strong></p>
</blockquote>
<p>这个教程是基于实例来讲解的，将会花费你 15-30 分钟的时间。</p>
<p>你将会学到 F# 这门语言 80% 的特性！</p>
<h3 id="例-1基本函数声明与实现">例 1：基本函数声明与实现</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">public</span> <span style="color:#8be9fd">int</span> GiveMeTheLength(<span style="color:#8be9fd">string</span> input)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 单行注释</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> result = input.Length;
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/* 多行注释 */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>变成了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">GiveMeTheLength</span><span style="color:#ff79c6">(</span>input<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 单行注释
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span> <span style="color:#ff79c6">=</span> input<span style="color:#ff79c6">.</span>Length
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">(* 多行注释 *)</span>
</span></span><span style="display:flex;"><span>    result
</span></span></code></pre></div><ul>
<li>所有东西都是默认为 <code>public</code> 的，除非你显式声明 <code>private</code> 修饰符。</li>
<li>关键字 <code>var</code> 变成了 <code>let</code>（不仅仅用来声明变量，还用来声明函数）。</li>
<li>你不再需要 <code>return</code> 关键字。函数的最后一行就是返回值。</li>
<li>不再需要花括号，使用 4 格（或者 2 格）缩进，就像 Python 一样。</li>
<li>不再需要分号来标志一行结束。</li>
<li>类型声明是可选的，除了极少数情况编译器无法推断类型。</li>
<li>单行注释和 C# 相同，但是多行注释使用括号而不是斜杠。</li>
</ul>
<p>如果你想要声明类型，需要这样写：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">GiveMeTheLength</span><span style="color:#ff79c6">(</span>input<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">string</span><span style="color:#ff79c6">):</span> int <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span><span style="color:#ff79c6">:</span> int <span style="color:#ff79c6">=</span> input<span style="color:#ff79c6">.</span>Length
</span></span><span style="display:flex;"><span>    result
</span></span></code></pre></div><h3 id="例-2基本关键字和操作符">例 2：基本关键字和操作符</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">using</span> System;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">class</span> <span style="color:#50fa7b">MainClass</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">void</span> Main()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">int</span> exitCode = <span style="color:#bd93f9">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (incomingChar == Environment.NewLine)
</span></span><span style="display:flex;"><span>            exitCode = <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">if</span> (!(incomingChar == String.Empty))
</span></span><span style="display:flex;"><span>            exitCode = <span style="color:#bd93f9">2</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">if</span> (incomingChar != <span style="color:#f1fa8c">&#34;\t&#34;</span> &amp;&amp; incomingChar.Length &gt; <span style="color:#bd93f9">1</span>)
</span></span><span style="display:flex;"><span>            exitCode = <span style="color:#bd93f9">3</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>            exitCode = <span style="color:#bd93f9">4</span>;
</span></span><span style="display:flex;"><span>        Environment.Exit(exitCode);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>变成了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">open</span> System
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">mutable</span> exitCode<span style="color:#ff79c6">:</span> int <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> incomingChar <span style="color:#ff79c6">=</span> Environment.NewLine <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>    exitCode <span style="color:#ff79c6">&lt;-</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">elif</span> <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">(</span>incomingChar <span style="color:#ff79c6">=</span> String.Empty<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>    exitCode <span style="color:#ff79c6">&lt;-</span> <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">elif</span> <span style="color:#ff79c6">(</span>incomingChar <span style="color:#ff79c6">&lt;&gt;</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\t</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">&amp;&amp;</span> incomingChar<span style="color:#ff79c6">.</span>Length <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>    exitCode <span style="color:#ff79c6">&lt;-</span> <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>    exitCode <span style="color:#ff79c6">&lt;-</span> <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>Environment.Exit<span style="color:#ff79c6">(</span>exitCode<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><ul>
<li><code>using</code> 关键字变成了 <code>open</code> 关键字。</li>
<li><code>if (x) foo(); else if (y) bar(); else baz();</code> 模式变成了 <code>if x then foo() elif y then bar() else baz()</code>，条件语句也不再需要圆括号。但是使用了新的关键字 <code>then</code> 和 <code>elif</code>。</li>
<li>初始赋值（只读常量）操作符是 <code>=</code>。如果你需要为这个元素重新赋值，你需要将它标记为 <code>mutable</code> 然后使用 <code>&lt;-</code> 操作符。</li>
<li>操作符 <code>=</code> 变成了比较符（不再需要像 C# 那样使用双等号 <code>==</code> 了）。</li>
<li>操作符 <code>!=</code> 变成了 <code>&lt;&gt;</code>。</li>
<li>操作符 <code>!</code> 变成了 <code>not</code>。</li>
<li>操作符 <code>&amp;&amp;</code> 和 <code>||</code> 在 F# 不变。</li>
<li>不再需要提供 Main() 方法这样的入口函数, 直接在一个 <code>.fsx</code> 文件中编写逻辑或者使用最新的 <code>.fs</code> 文件中编写语句以满足 F# 编译器要求。</li>
</ul>
<p>通常，上面的代码其实不需要使用 <code>mutable</code>，就像如下写法：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">open</span> System
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">exitCode</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> incomingChar <span style="color:#ff79c6">=</span> Environment.NewLine <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">elif</span> <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">(</span>incomingChar <span style="color:#ff79c6">=</span> String.Empty<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">elif</span> <span style="color:#ff79c6">(</span>incomingChar <span style="color:#ff79c6">&lt;&gt;</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\t</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">&amp;&amp;</span> incomingChar<span style="color:#ff79c6">.</span>Length <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Environment.Exit<span style="color:#ff79c6">(</span>exitCode<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><p>（这和 C# 中的三元操作符类似，但是可读性更高）</p>
<h3 id="例-3基础集合">例 3：基础集合</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#8be9fd">var</span> intArray = <span style="color:#ff79c6">new</span> <span style="color:#8be9fd">int</span>[] { <span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">2</span>, <span style="color:#bd93f9">3</span> };
</span></span><span style="display:flex;"><span><span style="color:#8be9fd">var</span> intList = <span style="color:#ff79c6">new</span> List&lt;<span style="color:#8be9fd">int</span>&gt;({ <span style="color:#bd93f9">4</span>, <span style="color:#bd93f9">5</span>, <span style="color:#bd93f9">6</span> });
</span></span><span style="display:flex;"><span>IEnumerable&lt;<span style="color:#8be9fd">int</span>&gt; sequenceOfIntegers = intList;
</span></span><span style="display:flex;"><span><span style="color:#8be9fd">var</span> dictionary = <span style="color:#ff79c6">new</span> Dictionary&lt;<span style="color:#8be9fd">int</span>,<span style="color:#8be9fd">string</span>&gt;() {
</span></span><span style="display:flex;"><span>    { <span style="color:#f1fa8c">&#34;One&#34;</span>, <span style="color:#bd93f9">1</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#f1fa8c">&#34;Two&#34;</span>, <span style="color:#bd93f9">2</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>变成了如下代码（其实你不需要声明类型，这里只是为了方便教学）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">intArray</span><span style="color:#ff79c6">:</span> array<span style="color:#ff79c6">&lt;</span>int<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[|</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">;</span> <span style="color:#bd93f9">2</span><span style="color:#ff79c6">;</span> <span style="color:#bd93f9">3</span> <span style="color:#ff79c6">|]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">intList</span><span style="color:#ff79c6">:</span> List<span style="color:#ff79c6">&lt;</span>int<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span> <span style="color:#bd93f9">4</span> <span style="color:#ff79c6">;</span> <span style="color:#bd93f9">5</span> <span style="color:#ff79c6">;</span> <span style="color:#bd93f9">6</span> <span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">sequenceOfIntegers</span><span style="color:#ff79c6">:</span> seq<span style="color:#ff79c6">&lt;</span>int<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span> intList
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">dictionary</span><span style="color:#ff79c6">:</span> IDictionary<span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd">string</span><span style="color:#ff79c6">,</span>int<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span> dict <span style="color:#ff79c6">[</span> <span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;One&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">);</span> <span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Two&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">]</span>
</span></span></code></pre></div><ul>
<li>声明 Array/List/Dictionary 时，逗号变成了分号。</li>
<li><code>IEnumerable&lt;T&gt;</code> 变成了 <code>seq&lt;'T&gt;</code>（Sequence 的缩写）。</li>
<li>你使用一个 <code>dict</code> 来初始化一个<code>IDictionary&lt;K,V&gt;</code> 集合，但是在 F# 中你将会更倾向于使用 <code>Map&lt;'K,'V&gt;</code> 因为它是可变的。</li>
</ul>
<p>你可能也注意到了，泛型类型需要一个前缀单引号「&rsquo;」</p>
<h3 id="例-4代码块">例 4：代码块</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>    TrySomething(someParam);
</span></span><span style="display:flex;"><span>} <span style="color:#ff79c6">catch</span> (SomeException ex) {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (SomeCondition(ex)) {
</span></span><span style="display:flex;"><span>        DoSomethingElse(ex);
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> OtherException();
</span></span><span style="display:flex;"><span>    } <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#ff79c6">finally</span> {
</span></span><span style="display:flex;"><span>    MakeSureToCleanup(someParam);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>变成了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">try</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">try</span>
</span></span><span style="display:flex;"><span>        TrySomething<span style="color:#ff79c6">(</span>someParam<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> <span style="color:#ff79c6">:?</span> SomeException <span style="color:#ff79c6">as</span> ex <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> SomeCondition<span style="color:#ff79c6">(</span>ex<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>            DoSomethingElse<span style="color:#ff79c6">(</span>ex<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>            raise OtherException
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>            reraise()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">finally</span>
</span></span><span style="display:flex;"><span>    MakeSureToCleanup<span style="color:#ff79c6">(</span>someParam<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><ul>
<li><code>catch</code> 变成了 <code>with</code> 关键字。</li>
<li><code>throw X;</code> 语句变成了 <code>raise X</code>，然后 <code>throw;</code> 变成了调用 <code>reraise()</code> 函数。</li>
<li>但是，没有 <code>try-with-catch</code> 块！F# 只有 <code>try-with</code> 和 <code>try-finally</code> 块。所以我们只能用两个 <code>try</code> 嵌套。</li>
</ul>
<p>你可能会想，这是 F# 的缺陷，但其实完整的 <code>try-catch-finally</code> 块很少用，尤其是有了 <code>using</code> 关键字：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">using</span> (<span style="color:#8be9fd">var</span> reader = <span style="color:#ff79c6">new</span> StreamReader(someFile))
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    DoStuff(reader);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>这变成了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">use</span> reader <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StreamReader<span style="color:#ff79c6">(</span>someFile<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>DoStuff<span style="color:#ff79c6">(</span>reader<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><ul>
<li>使用 <code>use</code> 就不再需要嵌套代码块了。</li>
<li>资源会自动释放（和 C# 的 using 相同）。</li>
</ul>
<h3 id="例-5避免-null-和忽略">例 5：避免 Null 和忽略</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">void</span> Check(SomeType someParam1, SomeType someParam2)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (someParam1 != <span style="color:#ff79c6">null</span>)
</span></span><span style="display:flex;"><span>        stringBuilder.Append(someParam1.ToString());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (someParam2 != <span style="color:#ff79c6">null</span>)
</span></span><span style="display:flex;"><span>        stringBuilder.Append(String.Empty);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>变成了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Check</span><span style="color:#ff79c6">(</span>someParam1<span style="color:#ff79c6">:</span> Option<span style="color:#ff79c6">&lt;</span>SomeType<span style="color:#ff79c6">&gt;,</span> someParam2<span style="color:#ff79c6">:</span> Option<span style="color:#ff79c6">&lt;</span>SomeType<span style="color:#ff79c6">&gt;):</span> <span style="color:#8be9fd">unit</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">match</span> someParam1 <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> Some<span style="color:#ff79c6">(</span>someValue<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">-&gt;</span> <span style="color:#6272a4">// like &#39;as&#39; in C#, you cast and want the value
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">str</span> <span style="color:#ff79c6">=</span> someValue<span style="color:#ff79c6">.</span>ToString()
</span></span><span style="display:flex;"><span>        ignore<span style="color:#ff79c6">(</span>stringBuilder<span style="color:#ff79c6">.</span>Append<span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> None <span style="color:#ff79c6">-&gt;</span> ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">match</span> someParam2 <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> Some<span style="color:#ff79c6">(_)</span> <span style="color:#ff79c6">-&gt;</span> <span style="color:#6272a4">// like &#39;is&#39; in C#, you don&#39;t care about the value
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stringBuilder<span style="color:#ff79c6">.</span>Append<span style="color:#ff79c6">(</span>String.Empty<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">|&gt;</span> ignore
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span> ()
</span></span></code></pre></div><p>在 C# 中你经常会到处写判空检查（没有编译时安全）。在 F# 中，你将使用更安全的 <code>Option&lt;T&gt;</code> 类型（与<code>Nullable&lt;T&gt;</code> 类似但是更棒）和 <code>match</code> 表达式（模式匹配）。</p>
<ul>
<li>当你不想返回任何东西时，在 C# 你会写 <code>void</code> 表示没有声明类型。但是在 F# 中你需要返回一个特殊的类 <code>unit</code>，它的默认值为 <code>()</code>。</li>
<li>一个 <code>match-with</code> 代码块基本上和 switch 代码块类似，但是更加简洁明了，因为它包含了 Casting（SomeValue）</li>
<li>这里有三个方式来实现忽略：
<ul>
<li>比方说，我们不关心 <code>Append()</code> 函数的返回值，在 C# 中我们就直接忽略，但是在 F# 中我们需要显式地忽略它，使用 <code>ignore()</code> 这个魔法方法。</li>
<li>Match 表达式的下划线：它就像 C# 的 <code>switch</code> 中的 <code>default</code> 分支。</li>
<li>在 <code>Some(_)</code> 中的下划线表示，我们想保证一个值不是空，但我们又不关心它的具体值（就像 C# 中的 <code>is</code> 操作符）。</li>
</ul>
</li>
<li>管道操作符：<code>ignore(x)</code> 与 <code>x |&gt; ignore</code> 等价。</li>
</ul>
<h3 id="例-6类型">例 6：类型</h3>
<p>下面这个类使用 F# 就简单很多。</p>
<p>（译者注：其实可以使用 C# 6.0 的自动完成属性或者 C# 9.0 的记录类）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">public</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Foo</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">public</span> Foo (<span style="color:#8be9fd">int</span> bar, <span style="color:#8be9fd">string</span> baz)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.bar = bar;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.baz = baz;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">readonly</span> <span style="color:#8be9fd">int</span> bar;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">public</span> <span style="color:#8be9fd">int</span> Bar
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">get</span> { <span style="color:#ff79c6">return</span> bar; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">readonly</span> <span style="color:#8be9fd">string</span> baz;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">public</span> <span style="color:#8be9fd">string</span> Baz
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">get</span> { <span style="color:#ff79c6">return</span> baz; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">FooFactory</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">internal</span> Foo CreateFoo()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> Foo(<span style="color:#bd93f9">42</span>, <span style="color:#f1fa8c">&#34;forty-two&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>在 F# 中就一行：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Foo</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> Bar<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">;</span> Baz<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">string</span> <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">module</span> FooFactory <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">internal</span> CreateFoo () <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">{</span> Bar <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">42</span><span style="color:#ff79c6">;</span> Baz <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;forty-two&#34;</span> <span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>由此可见:</p>
<ul>
<li>没有动作行为的类（就像上面的 Foo 类）叫作「记录类 Record」，长得像 C# 的结构体但是它们依然是引用类型，并且被保存在堆上。记录类是不可变的。也就是说，一旦你创建它们，就不能再修改它们的值了。</li>
<li>静态类变成了「modules」，如上 <code>FooFactory</code> 类。</li>
<li>在 F# 中，不需要使用 <code>new</code> 关键字，除非这个类实现了 <code>IDisposable</code> 接口。</li>
</ul>
<h3 id="例-7函数的顺序很重要循环依赖是万恶之源">例 7：函数的顺序很重要，循环依赖是万恶之源</h3>
<p>作为 C# 开发者，你当然知道下面的代码可以通过编译：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Foo</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> Bar()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (Baz())
</span></span><span style="display:flex;"><span>            Bar();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#8be9fd">bool</span> Baz()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>理所应当！下面的代码也可以通过编译：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Foo1</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">public</span> <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> Bar()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> Baz()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Foo2.Baz();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Foo2</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> Bar()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Foo1.Bar();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">public</span> <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> Baz()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>也许你明白我说到哪里了。</p>
<p>后一段 C# 代码可以通过编译，是因为 C# 允许循环依赖（Circular Dependencies）。</p>
<p>但是这句话半对半错，因为在 C# 中循环依赖是合法的，但是在 .NET 程序集里不合法。如果程序集 A 依赖于程序集 B，你不能从 A 引用 B。</p>
<p>这个模块性原则将会阻止你写出上面的代码，因为在未来你将不能将它们分为两个程序集（你不能将 Foo1 放进一个程序集里，然后把 Foo2 放进另一个程序集，因为在 .NET 中这并不合法）。</p>
<p>之后，你需要了解的是，在 F# 中，即使在同一程序集里，循环依赖<strong>也不合法</strong>！</p>
<p>通过强制你在类型 B 之前声明 类型 A，防止你在之后的函数中调用前面的函数时出错。</p>
<p>因此，下面的 F# 编译时会报错：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">module</span> Foo1 <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Bar</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Baz</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        Foo2.Baz()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">module</span> Foo2 <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Bar</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        Foo1.Bar()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Baz</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        ()
</span></span></code></pre></div><p>为什么呢？来看看它的报错：</p>
<ul>
<li>Error FS0039: The value, namespace, type or module &lsquo;Foo2&rsquo; is not defined. (Referring to Foo1.Baz implementation.)</li>
</ul>
<p>这个报错是不能修复的，除非我们直接停止使用循环依赖。</p>
<p>（还有一些特殊情况，比如使用 <code>via</code> 和 <code>rec</code> 关键字，但是在本教程中并不会讲解，因为太高级了）</p>
<p>F# 编译器严格限制了我们不能循环依赖，这意味着如果函数 A 调用了函数 B，那么函数 B 就必须在 A 之前声明</p>
<p>（如果这两个函数在同一个文件中，那么函数 B 就是在函数 A 上面；如果这两个函数在同一 F# 工程下不同文件中，那么 <code>B.fs</code> 必须比 <code>A.fs</code> 早列出）</p>
<p>因此，下面的代码也不会通过编译：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">module</span> Foo <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Bar</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> Baz() <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>            Bar()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Baz</span>()<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">bool</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">false</span>
</span></span></code></pre></div><p>它抛出了如下错误：</p>
<ul>
<li>Error FS0039: The value or constructor &lsquo;Baz&rsquo; is not defined. (Referring to Foo.Bar implementation.)</li>
<li>Error FS0039: The value or constructor &lsquo;Bar&rsquo; is not defined. (Referring to Foo.Bar implementation.)</li>
</ul>
<p>正如我们刚刚学到的，这更容易解决；只要先声明 <code>Baz</code> 即可。</p>
<p>而为了让一个函数能够调用自己（在某种程度上，它也是一个循环依赖），我们使用 <code>rec</code> 关键字（意思就是「递归」)：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">module</span> Foo <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Baz</span>()<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">bool</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">rec</span> Bar() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> Baz() <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>            Bar()
</span></span></code></pre></div><h3 id="例-8委托匿名函数我的老天爷">例 8：委托、匿名函数···我的老天爷！</h3>
<p>在 C# 的早期版本中，需要通过委托类型和匿名函数传递函数。请看下面有 4 种组合的例子：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">SomeOldCsharpClass</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">delegate</span> <span style="color:#ff79c6">void</span> ProcedureWithNoReturnValueAndNoArguments();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> DelegateReception1(ProcedureWithNoReturnValueAndNoArguments dlg)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        dlg.Invoke();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate1()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        DelegateReception1(<span style="color:#ff79c6">delegate</span> ()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 1&#34;</span>);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">delegate</span> <span style="color:#ff79c6">void</span> ProcedureWithNoReturnValueAndOneArg(<span style="color:#8be9fd">string</span> foo);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> DelegateReception2(ProcedureWithNoReturnValueAndOneArg dlg)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">string</span> bar = <span style="color:#f1fa8c">&#34;baz&#34;</span>;
</span></span><span style="display:flex;"><span>        dlg.Invoke(bar);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate2()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        DelegateReception2(<span style="color:#ff79c6">delegate</span> (<span style="color:#8be9fd">string</span> foo)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 2 &#34;</span> + foo);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">delegate</span> <span style="color:#8be9fd">int</span> FunctionWithOneReturnValueAndNoArguments();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> DelegateReception3(FunctionWithOneReturnValueAndNoArguments dlg)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">int</span> result = dlg.Invoke();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate3()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        DelegateReception3(<span style="color:#ff79c6">delegate</span> ()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 3&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">3</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">delegate</span> <span style="color:#8be9fd">long</span> FunctionWithOneReturnValueAndOneArg(<span style="color:#8be9fd">double</span> foo);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> DelegateReception4(FunctionWithOneReturnValueAndOneArg dlg)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">double</span> bar = <span style="color:#bd93f9">4.0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">long</span> result = dlg.Invoke(bar);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate4()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        DelegateReception4(<span style="color:#ff79c6">delegate</span> (<span style="color:#8be9fd">double</span> foo)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 4 &#34;</span> + foo);
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">4</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>但后来新版本的 C# 出现了更优雅的方式（得益于局部函数）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">SomeNewCsharpClass</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate1()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">void</span> DelegateReception1(Action dlg)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            dlg.Invoke();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception1(() =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 1&#34;</span>);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate2()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">void</span> DelegateReception2(Action&lt;<span style="color:#8be9fd">string</span>&gt; dlg)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">string</span> bar = <span style="color:#f1fa8c">&#34;baz&#34;</span>;
</span></span><span style="display:flex;"><span>            dlg.Invoke(bar);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception2((<span style="color:#8be9fd">string</span> foo) =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 2 &#34;</span> + foo);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate3()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">void</span> DelegateReception3(Func&lt;<span style="color:#8be9fd">int</span>&gt; dlg)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">int</span> result = dlg.Invoke();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception3(() =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 3&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">3</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> SendingAnonymousMethodAsDelegate4()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">void</span> DelegateReception4(Func&lt;<span style="color:#8be9fd">double</span>, <span style="color:#8be9fd">long</span>&gt; dlg)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">double</span> bar = <span style="color:#bd93f9">4.0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">long</span> result = dlg.Invoke(bar);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception4((<span style="color:#8be9fd">double</span> foo) =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;hello 4 &#34;</span> + foo);
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">4</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>最有趣的改进就是 .NET 预定义的 <code>Action</code> 和 <code>Func</code> 类型，以及 Lambda 表达式。</p>
<p>好消息是在 F# 中，函数是一等公民。因此代码更加简单：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">module</span> SomeFsharpModule <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate1</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception1</span><span style="color:#ff79c6">(</span>dlg<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">unit</span><span style="color:#ff79c6">-&gt;</span><span style="color:#8be9fd">unit</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            dlg()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception1<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;hello 1&#34;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate2</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception2</span><span style="color:#ff79c6">(</span>dlg<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">string</span><span style="color:#ff79c6">-&gt;</span><span style="color:#8be9fd">unit</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">bar</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;baz&#34;</span>
</span></span><span style="display:flex;"><span>            dlg<span style="color:#ff79c6">(</span>bar<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception2<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> bar <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;hello 2 &#34;</span> <span style="color:#ff79c6">+</span> bar<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate3</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception3</span><span style="color:#ff79c6">(</span>dlg<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">unit</span><span style="color:#ff79c6">-&gt;</span>int<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span> <span style="color:#ff79c6">=</span> dlg()
</span></span><span style="display:flex;"><span>            ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception3<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;hello 3&#34;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate4</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception4</span><span style="color:#ff79c6">(</span>dlg<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">double</span><span style="color:#ff79c6">-&gt;</span><span style="color:#8be9fd">int64</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">bar</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">4</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span> <span style="color:#ff79c6">=</span> dlg<span style="color:#ff79c6">(</span>bar<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>            ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception4<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> bar <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;hello 4 &#34;</span> <span style="color:#ff79c6">+</span> bar<span style="color:#ff79c6">.</span>ToString()<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">int64</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">4</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span></code></pre></div><p>正如你所看到的，BCL 的 <code>System.Function</code> 和 <code>System.Action</code> 变成了原生 F# 语法。</p>
<p>通过 <code>-&gt;</code> 符号来表示参数和返回值，例如 <code>TArg1-&gt;TResult</code>。请记住，<code>void</code> 在 F# 中是 <code>unit</code>。</p>
<p>同样重要的是，C# 的 <code>(...) =&gt; { ... }</code> 变成了 <code>fun ... -&gt; ...</code></p>
<h3 id="例-9元组局部应用以及柯里化">例 9：元组、局部应用以及柯里化</h3>
<p>如果你没有做过函数式编程，你可能会对其中的一些概念感到害怕，比如「局部应用 Partial Application」「柯里化 Currification」。</p>
<p>但事实是，它们并不是那么复杂的概念。为了正确解释它们，我们需要先解释元组，以及为什么不建议在 F# 中滥用它们。</p>
<p>（事实上，你不能用元组来使用局部应用！稍后将详细介绍）</p>
<p>让我们先看看下面这段使用 <code>out</code> 参数的 C# 代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#8be9fd">int</span> anInteger;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> (<span style="color:#8be9fd">int</span>.TryParse(someString, <span style="color:#ff79c6">out</span> anInteger)) {
</span></span><span style="display:flex;"><span>    DoSomethingWithAnInteger(anInteger);
</span></span><span style="display:flex;"><span>} <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>    DoSomethingElse();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>如果你尝试将上面的 C# 代码转译成 F#，你首先会有一个疑问：我们怎样声明一个变量但不给它赋值呢？相信我，F# 是不可能做到的。</p>
<p>你可能会想到先随便给变量 <code>anInteger</code> 赋一个值，反正最后会被 <code>TryParse()</code> 方法覆写。但是这种方式不够优雅，尤其是把变量标记为 <code>mutable</code>，不符合 F# 的语言习惯。</p>
<p>最好的方法是使用「积极模式 Acitve Pattern」——将上面多个函数转换成一个函数，并且同时虚拟地返回两个值：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">match</span> int<span style="color:#ff79c6">.</span>TryParse<span style="color:#ff79c6">(</span>someString<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">|</span> <span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">,</span> anInteger<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">-&gt;</span> DoSomethingWithAnInteger<span style="color:#ff79c6">(</span>anInteger<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">|</span> <span style="color:#ff79c6">(</span><span style="color:#ff79c6">false</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">_)</span> <span style="color:#ff79c6">-&gt;</span> DoSomethingElse()
</span></span></code></pre></div><p>积极模式为 F# 编译器提供了语法糖，将 <code>bool TryParse(string,out int)</code> 转换成了类似 <code>(bool,int) TryParse(string)</code> 的函数，而 <code>(bool,int)</code> 是一个元组！</p>
<p>所以在 F# 中，创建任意长度的元组是很容易的事情，不需要使用 <code>System.Tuple&lt;X,Y,...&gt;</code>。</p>
<p>这让我想起了新版本 C# 对于元组的改进——你可以在函数的签名里使用元组而不需要用 <code>Tuple</code>。</p>
<p>来检查一下我说的是什么意思吧。这是 C# 的老式写法：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#8be9fd">bool</span> ReceiveTuple(Tuple&lt;<span style="color:#8be9fd">string</span>,<span style="color:#8be9fd">int</span>&gt; aTuple)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> counter = aTuple.Item2++;
</span></span><span style="display:flex;"><span>    Console.WriteLine(aTuple.Item1);
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> newTuple = <span style="color:#ff79c6">new</span> Tuple&lt;<span style="color:#8be9fd">string</span>,<span style="color:#8be9fd">int</span>&gt;(aTuple.Item1, counter)
</span></span><span style="display:flex;"><span>    ReceiveTuple(newTuple);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>如果我们想要一个变量指向这个函数，它的类型就应是 <code>Func&lt;Tuple&lt;string,int&gt;,bool&gt;</code>。</p>
<p>新式的 C# 写法（会被编译成 <code>ValueTuple&lt;X,Y,...&gt;</code>）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#8be9fd">bool</span> ReceiveTuple((<span style="color:#8be9fd">string</span> str, <span style="color:#8be9fd">int</span> i) aTuple)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> counter = aTuple.i++;
</span></span><span style="display:flex;"><span>    Console.WriteLine(aTuple.str);
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> newTuple = (aTuple.str, counter);
</span></span><span style="display:flex;"><span>    ReceiveTuple(newTuple);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>现在我们有了一个指向这个函数的变量，它的类型是 <code>Func&lt;ValueTuple&lt;string,int&gt;,bool&gt;</code>。</p>
<p>使用 F#：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">rec</span> ReceiveTuple<span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">string</span><span style="color:#ff79c6">,</span> i<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">counter</span> <span style="color:#ff79c6">=</span> i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    Console.WriteLine<span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">newTuple</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">,</span> counter<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    ReceiveTuple <span style="color:#ff79c6">(</span>newTuple<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">true</span>
</span></span></code></pre></div><p>在这种情况下，你引用这个函数的 F# 类型是 <code>string*int-&gt;bool</code>；所以我们学到了一个新的符号：星号「*」在其它语言里代表指针，但在 F# 中它只是元组中类型的分隔符。</p>
<p>你是否注意到元组是如何融入到 F# 中那些看似正常的参数中的？事实上，本指南到现在为止，我们在 F# 中写的所有接收多参的函数，实际上都在使用元组。不用元组能在 F# 中写出的上述方法吗？当然可以，只是省略了逗号：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">rec</span> ReceiveNonTuple <span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">string</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">counter</span> <span style="color:#ff79c6">=</span> i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    Console.WriteLine<span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    ReceiveNonTuple str counter
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">true</span>
</span></span></code></pre></div><p>函数 <code>ReceiveTuple</code> 和 <code>ReceiveNonTuple</code> 之间有什么区别？两者都接收相同数量的参数，并且具有相同的类型。但是，第一个函数的参数是 F# 元组，而第二个函数的参数则是以 F# 语言惯用方式声明的（以「柯里化」的形式）。</p>
<p>为什么后者在 F# 中更符合语言习惯？因为 <code>ReceiveTuple</code> 不能用于局部应用，而<code>ReceiveNonTuple</code> 可以，因为它使用的是「柯里化」风格。在这种情况下，函数的类型不是 <code>string*int-&gt;bool</code>，而是 <code>(string-&gt;int)-&gt;bool</code>。</p>
<p>那为什么 <code>(string-&gt;int)-&gt;bool</code> 比 <code>string*int-&gt;bool</code> 更好呢？</p>
<p>后者允许与 C# 的互操作（因为这是以 CIL 级别传递参数的方式），但前者允许以非常直接和简洁的方式进行局部应用（我们将在后面看到，部分应用在 C# 中也是可能的，但方式非常复杂，可读性/维护性很差）。</p>
<p>因此，不再多说，让我们看看一个非常简单的部分应用的例子。假设我们想创建一个乘法函数，接收两个整数并返回一个整数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Multiply</span> <span style="color:#ff79c6">(</span>x<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>y<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">):</span> int <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    x <span style="color:#ff79c6">*</span> y
</span></span></code></pre></div><p>现在，如果我们想写一个函数将一个数字的值增加一倍，而不需要重复乘法函数的任何实现细节，我们可以简单地这样写：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Double</span> <span style="color:#ff79c6">(</span>x<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">):</span> int <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    Multiply <span style="color:#bd93f9">2</span>
</span></span></code></pre></div><p>当我们只向函数 <code>Multiply</code> 传递一个参数时会发生什么？</p>
<p>让我们看看它的原始签名：<code>(int-&gt;int)-&gt;int</code>。「柯里法则」告诉我们，在类型表达式中使用小括号实际上是不需要的（或者把它们放在其他地方会得到一个等价的表达式）。这意味着我们也可以这样写 <code>int-&gt;int-&gt;int</code> 或者这样写 <code>int-&gt;（int-&gt;int）</code>。因此，向一个原本接收两个参数的函数只传递一个参数，实际上会导致返回另一个函数。</p>
<p>我们可以这样更好地理解它：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Double</span> <span style="color:#ff79c6">(</span>x<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">):</span> int <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">doubleFunc</span> <span style="color:#ff79c6">=</span> Multiply <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span> <span style="color:#ff79c6">=</span> doubleFunc x
</span></span><span style="display:flex;"><span>    result
</span></span></code></pre></div><p>或者这样（冗长的类型声明）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Double</span> <span style="color:#ff79c6">(</span>x<span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">):</span> int <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">doubleFunc</span><span style="color:#ff79c6">:</span> int<span style="color:#ff79c6">-&gt;</span>int <span style="color:#ff79c6">=</span> Multiply <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span><span style="color:#ff79c6">:</span> int <span style="color:#ff79c6">=</span> doubleFunc x
</span></span><span style="display:flex;"><span>    result
</span></span></code></pre></div><p>这是一个非常简单的例子，也许能让你明白局部应用的强大之处。但它是函数式编程中的依赖注入等操作的基础。随着时间的推移，你可能只会掌握它所带来的灵活性，但至少我们已经可以向你展示它在 F# 中的简单性。在 C# 中，我们只能这样来实现：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">static</span> Func&lt;<span style="color:#8be9fd">int</span>, Func&lt;<span style="color:#8be9fd">int</span>, <span style="color:#8be9fd">int</span>&gt;&gt; Multiply()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> (x) =&gt; {
</span></span><span style="display:flex;"><span>        (y) =&gt; {
</span></span><span style="display:flex;"><span>            x * y;
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> Function&lt;<span style="color:#8be9fd">int</span>,<span style="color:#8be9fd">int</span>&gt; Double()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> Multiply().Invoke(<span style="color:#bd93f9">2</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#8be9fd">int</span> Main()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> someInt = <span style="color:#bd93f9">3</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> Double().Invoke(someInt);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>你的大脑能转过弯儿来吗？对我来说，这比阅读 F# 代码难理解多了。</p>
<p>关于局部应用及其用处的最后说明：你使用 F# 的时间越长，你就会意识到局部应用实际上是一种简化的依赖注入/控制反转（DI / IoC）方式，详见<a href="https://blog.ploeh.dk/2017/01/30/partial-application-is-dependency-injection/">《局部应用就是依赖注入》</a>一文。</p>
<h3 id="例-10字符串插值">例 10：字符串插值</h3>
<p>在早期的 C# 版本中，你需要这样写：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#8be9fd">var</span> aStringToShowToTheUser = String.Format(<span style="color:#f1fa8c">&#34;Hello {0}, I see you are {1} years old&#34;</span>, name, age);
</span></span></code></pre></div><p>这有两个问题：在大型代码库中，许多变量和元素被包含在一个字符串中，我们索引了一个没有提供的变量（例如 <code>{2}</code>）很容易发生，或者我们提供的变量没有隐式转换为字符串。</p>
<p>在 F# 中是这样的：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">aStringToShowToTheUser</span> <span style="color:#ff79c6">=</span> sprintf <span style="color:#f1fa8c">&#34;Hello %s, I see you are %i years old&#34;</span> name age
</span></span></code></pre></div><p>哪个更好？</p>
<ul>
<li>如果你提供的参数少于（或多于）在字符串中插值所需的参数，你将得到一个编译器错误，而不是在运行时出现异常。</li>
<li>你需要通过 <code>%</code> 后面的字母来指定字符串中元素的类型，如果它与为同一位置提供的元素的类型不匹配，那么你会得到一个编译器错误（而不是一个无用的元素字符串表示）。</li>
<li>你需要更少的小括号（参见本指南中的最后一个例子）。</li>
</ul>
<h3 id="例-11异步代码">例 11：异步代码</h3>
<p>一段简单的 C# 异步代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">MainClass</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">public</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Toast</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">public</span> <span style="color:#8be9fd">bool</span> IsYummy()
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task&lt;Toast&gt; ToastBreadAsync()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">var</span> task = Task.Run(() =&gt;
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">new</span> Toast()
</span></span><span style="display:flex;"><span>            );
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">await</span> task;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> ApplyButter(Toast toast) { <span style="color:#6272a4">/* TODO */</span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">void</span> ApplyJam(Toast toast) { <span style="color:#6272a4">/* TODO */</span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task&lt;Toast&gt; MakeToastWithButterAndJamAsync()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">var</span> toast = <span style="color:#ff79c6">await</span> ToastBreadAsync();
</span></span><span style="display:flex;"><span>            ApplyButter(toast);
</span></span><span style="display:flex;"><span>            ApplyJam(toast);
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> toast;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">public</span> <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task Main(<span style="color:#8be9fd">string</span>[] args)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;Hello World!&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">var</span> toast = <span style="color:#ff79c6">await</span> MakeToastWithButterAndJamAsync();
</span></span><span style="display:flex;"><span>            Console.WriteLine(<span style="color:#f1fa8c">&#34;Bye World!&#34;</span> + toast.IsYummy());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>在 F# 中变成了：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Toast</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">member</span> this.<span style="color:#50fa7b">IsYummy</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">ToastBread</span>()<span style="color:#ff79c6">:</span> Async<span style="color:#ff79c6">&lt;</span>Toast<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> Toast()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">ApplyButter</span><span style="color:#ff79c6">(</span>toast<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    () <span style="color:#6272a4">//TODO
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">ApplyJam</span><span style="color:#ff79c6">(</span>toast<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    () <span style="color:#6272a4">//TODO
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">MakeToastWithButterAndJam</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let!</span> <span style="color:#8be9fd;font-style:italic">toast</span> <span style="color:#ff79c6">=</span> ToastBread()
</span></span><span style="display:flex;"><span>        ApplyButter<span style="color:#ff79c6">(</span>toast<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>        ApplyJam<span style="color:#ff79c6">(</span>toast<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> toast
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[&lt;</span>EntryPoint<span style="color:#ff79c6">&gt;]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">main</span><span style="color:#ff79c6">(</span>argv<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Hello World!&#34;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">toast</span> <span style="color:#ff79c6">=</span> MakeToastWithButterAndJam()
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">|&gt;</span> Async.RunSynchronously
</span></span><span style="display:flex;"><span>    Console.WriteLine <span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Bye world!&#34;</span> <span style="color:#ff79c6">+</span> <span style="color:#ff79c6">(</span>toast<span style="color:#ff79c6">.</span>IsYummy()<span style="color:#ff79c6">.</span>ToString()<span style="color:#ff79c6">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#bd93f9">0</span> <span style="color:#6272a4">// return an integer exit code
</span></span></span></code></pre></div><p>关键不同点：</p>
<ul>
<li>在 C# 中，当你调用一个异步方法时，你会得到一个 <code>Task&lt;T&gt;</code> 对象，它代表正在进行的工作，并且已经被启动。但在 F# 中，Job 是由一个 <code>Async&lt;'T&gt;</code> 对象表示的，它还没有被启动（你可以在之后决定如何启动它；例如，在上面例子中，它用 <code>Async.RunSynchronously</code> 来启动）。</li>
<li>在 F# 的 <code>let</code> 语句后面加上惊叹号 <code>!</code> 等价于 C# 的 <code>await</code>。</li>
<li>在 C# 中，你将计算量大的同步方法包装在 <code>Task.Run()</code> 中，将其转换为异步方法。在 F# 中，你只需用 <code>async{}</code> 块（一个计算表达式）来包装它们。</li>
</ul>
<p>如果我们稍微改变上面的 C# 代码，引入非泛型 Task 对象和并行化（假设我们有两个烤面包机）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#ff79c6">public</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Ingredients</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">public</span> <span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Toast</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">public</span> Toast(Ingredients i)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task&lt;Toast&gt; ToastBreadAsync(Ingredients i)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> task = Task.Run(() =&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">new</span> Toast(i)
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">await</span> task;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task&lt;Toast[]&gt; Make2ToastsAsync(Ingredients i)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> toast1 = ToastBreadAsync(i);
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> toast2 = ToastBreadAsync(i);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">await</span> Task.WhenAll(toast1, toast2);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task MakeToastsAsync()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">var</span> i = <span style="color:#ff79c6">await</span> GatherIngredients();
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">await</span> Make2ToastsAsync(i);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">public</span> <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task&lt;Ingredients&gt; GatherIngredients()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">await</span> Task.FromResult(<span style="color:#ff79c6">new</span> Ingredients());
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">public</span> <span style="color:#ff79c6">static</span> <span style="color:#ff79c6">async</span> Task Main(<span style="color:#8be9fd">string</span>[] args)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    Console.WriteLine(<span style="color:#f1fa8c">&#34;Hello World!&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">await</span> MakeToastsAsync();
</span></span><span style="display:flex;"><span>    Console.WriteLine(<span style="color:#f1fa8c">&#34;Bye World!&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>在 F# 中，这变成了：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Ingredients</span> () <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">class</span> <span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Toast</span> <span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">:</span> Ingredients<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">class</span> <span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">ToastBread</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">):</span> Async<span style="color:#ff79c6">&lt;</span>Toast<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> Toast<span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">GatherIngredients</span> () <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span> <span style="color:#ff79c6">return</span> Ingredients() <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Make2Toasts</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">twoJobs</span><span style="color:#ff79c6">:</span> List<span style="color:#ff79c6">&lt;</span>Async<span style="color:#ff79c6">&lt;</span>Toast<span style="color:#ff79c6">&gt;&gt;</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span>ToastBread<span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">);</span> ToastBread<span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">)]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let!</span> <span style="color:#8be9fd;font-style:italic">_</span> <span style="color:#ff79c6">=</span> Async.Parallel<span style="color:#ff79c6">(</span>twoJobs<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> ()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">MakeToasts</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let!</span> <span style="color:#8be9fd;font-style:italic">i</span> <span style="color:#ff79c6">=</span> GatherIngredients()
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">do</span><span style="color:#ff79c6">!</span> Make2Toasts<span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[&lt;</span>EntryPoint<span style="color:#ff79c6">&gt;]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">main</span><span style="color:#ff79c6">(</span>argv<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Hello World!&#34;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    MakeToasts()
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">|&gt;</span> Async.RunSynchronously
</span></span><span style="display:flex;"><span>    Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Bye world!&#34;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#bd93f9">0</span> <span style="color:#6272a4">// return an integer exit code
</span></span></span></code></pre></div><p>正如你所看到的：</p>
<ul>
<li>在 C# 中处理非泛型 Task，在 F# 中意味着使用 <code>unit</code> 作为 <code>Async</code> 的泛型参数：<code>Async&lt;unit&gt;</code>。不要使用 <code>let! x = ...</code>，你只需要 <code>do!</code>。</li>
<li><code>Task.WhenAll</code> 的等价物是 <code>Async.Parallel</code>。</li>
</ul>
<h3 id="例-12编写更少符号提升-f-脚本的可阅读性">例 12：编写更少符号，提升 F# 脚本的可阅读性！</h3>
<p>相信你已经明白了 F# 中元组和柯里化参数的区别。后者更推荐使用。</p>
<p>你可能明白，写这么多小括号其实只是为了映射元组中的东西。事实上，这是刚从 C# 转到 F# 的思维惯性。</p>
<p>F# 的简洁之处：</p>
<ul>
<li>没有那么多的括号，因为你不再使用元组了。</li>
<li>不需要使用分号，如果你只使用 EOL 分隔符。</li>
<li>不需要使用大括号（在 F# 中处理记录类型时才需要它们）。</li>
<li>让 F# 编译器推断类型，就不需要多次使用冒号 <code>:</code>。</li>
<li>更多地使用管道运算符 <code>|&gt;</code>，以避免在一大串代码的右边还要写一堆小括号。</li>
<li>在 F# 中的 <code>if</code> 表达式中不需要小括号（与 C# 相反）。</li>
</ul>
<p>有了这些要点，我们来重写之前的所有 F# 实例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">open</span> System
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">exitCode</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> incomingChar <span style="color:#ff79c6">=</span> Environment.NewLine <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">elif</span> <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">(</span>incomingChar <span style="color:#ff79c6">=</span> String.Empty<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">elif</span> incomingChar <span style="color:#ff79c6">&lt;&gt;</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\t</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">&amp;&amp;</span> incomingChar<span style="color:#ff79c6">.</span>Length <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Environment.Exit exitCode
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">intArray</span> <span style="color:#ff79c6">=</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">[|</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>           <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>           <span style="color:#bd93f9">3</span> <span style="color:#ff79c6">|]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">intList</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">[</span> <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>          <span style="color:#bd93f9">5</span>
</span></span><span style="display:flex;"><span>          <span style="color:#bd93f9">6</span> <span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">sequenceOfIntegers</span> <span style="color:#ff79c6">=</span> intList
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">dic</span> <span style="color:#ff79c6">=</span> dict <span style="color:#ff79c6">[</span> <span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;One&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Two&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">2</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">try</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">try</span>
</span></span><span style="display:flex;"><span>        TrySomething someParam
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> <span style="color:#ff79c6">:?</span> SomeException <span style="color:#ff79c6">as</span> ex <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> SomeCondition ex <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>            DoSomethingElse ex
</span></span><span style="display:flex;"><span>            raise OtherException
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>            reraise()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">finally</span>
</span></span><span style="display:flex;"><span>    MakeSureToCleanup someParam
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">use</span> reader <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StreamReader someFile
</span></span><span style="display:flex;"><span>DoStuff reader
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Check</span> someParam1 someParam2 <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">match</span> someParam1 <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> Some someValue <span style="color:#ff79c6">-&gt;</span> <span style="color:#6272a4">// like &#39;as&#39; in C#, you cast and want the value
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">str</span> <span style="color:#ff79c6">=</span> someValue<span style="color:#ff79c6">.</span>ToString()
</span></span><span style="display:flex;"><span>        stringBuilder<span style="color:#ff79c6">.</span>Append str <span style="color:#ff79c6">|&gt;</span> ignore
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> None <span style="color:#ff79c6">-&gt;</span> ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">match</span> someParam2 <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> Some <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span> <span style="color:#6272a4">// like &#39;is&#39; in C#, you don&#39;t care about the value
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stringBuilder<span style="color:#ff79c6">.</span>Append String.Empty <span style="color:#ff79c6">|&gt;</span> ignore
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">|</span> <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span> ()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Foo</span> <span style="color:#ff79c6">=</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">{</span> Bar<span style="color:#ff79c6">:</span> int
</span></span><span style="display:flex;"><span>      Baz<span style="color:#ff79c6">:</span> <span style="color:#8be9fd">string</span> <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">module</span> FooFactory <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">internal</span> CreateFoo () <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">{</span> Bar <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">42</span>
</span></span><span style="display:flex;"><span>          Baz <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;forty-two&#34;</span> <span style="color:#ff79c6">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">module</span> Foo <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Baz</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">rec</span> Bar() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> Baz() <span style="color:#ff79c6">then</span>
</span></span><span style="display:flex;"><span>            Bar()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">module</span> SomeFsharpModule <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate1</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception1</span> dlg <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            dlg()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception1<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine <span style="color:#f1fa8c">&#34;hello 1&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate2</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception2</span> dlg <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">bar</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;baz&#34;</span>
</span></span><span style="display:flex;"><span>            dlg bar
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception2<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> bar <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;hello 2 &#34;</span> <span style="color:#ff79c6">+</span> bar<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate3</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception3</span> dlg <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span> <span style="color:#ff79c6">=</span> dlg()
</span></span><span style="display:flex;"><span>            ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception3<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine <span style="color:#f1fa8c">&#34;hello 3&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">SendingAnonymousMethodAsDelegate4</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">DelegateReception4</span> dlg <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">bar</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">4</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span> <span style="color:#ff79c6">=</span> dlg bar
</span></span><span style="display:flex;"><span>            ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        DelegateReception4<span style="color:#ff79c6">(</span><span style="color:#ff79c6">fun</span> bar <span style="color:#ff79c6">-&gt;</span>
</span></span><span style="display:flex;"><span>            Console.WriteLine<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;hello 4 &#34;</span> <span style="color:#ff79c6">+</span> bar<span style="color:#ff79c6">.</span>ToString()<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">int64</span> <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">match</span> int<span style="color:#ff79c6">.</span>TryParse someString <span style="color:#ff79c6">with</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">|</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">,</span> anInteger <span style="color:#ff79c6">-&gt;</span> DoSomethingWithAnInteger anInteger
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">|</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">_</span> <span style="color:#ff79c6">-&gt;</span> DoSomethingElse()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">rec</span> ReceiveNonTuple str i <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">counter</span> <span style="color:#ff79c6">=</span> i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    Console.WriteLine str
</span></span><span style="display:flex;"><span>    ReceiveNonTuple str counter
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">true</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Multiply</span> x y <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    x <span style="color:#ff79c6">*</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Double</span> x <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">doubleFunc</span> <span style="color:#ff79c6">=</span> Multiply <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">result</span> <span style="color:#ff79c6">=</span> doubleFunc x
</span></span><span style="display:flex;"><span>    result
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">aStringToShowToTheUser</span> <span style="color:#ff79c6">=</span> sprintf <span style="color:#f1fa8c">&#34;Hello %s, I see you are %i years old&#34;</span> name age
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span><span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Ingredients</span> () <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">class</span> <span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Toast</span> <span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">:</span> Ingredients<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">class</span> <span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">ToastBread</span> i<span style="color:#ff79c6">:</span> Async<span style="color:#ff79c6">&lt;</span>Toast<span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> Toast i
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">GatherIngredients</span> () <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span> <span style="color:#ff79c6">return</span> Ingredients() <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">Make2Toasts</span> i <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">twoJobs</span><span style="color:#ff79c6">:</span> List<span style="color:#ff79c6">&lt;</span>Async<span style="color:#ff79c6">&lt;</span>Toast<span style="color:#ff79c6">&gt;&gt;</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span>ToastBread i<span style="color:#ff79c6">;</span> ToastBread i<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let!</span> <span style="color:#8be9fd;font-style:italic">_</span> <span style="color:#ff79c6">=</span> Async.Parallel twoJobs
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> ()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">MakeToasts</span>() <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    async <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">let!</span> <span style="color:#8be9fd;font-style:italic">i</span> <span style="color:#ff79c6">=</span> GatherIngredients()
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">do</span><span style="color:#ff79c6">!</span> Make2Toasts i
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[&lt;</span>EntryPoint<span style="color:#ff79c6">&gt;]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">let</span> <span style="color:#8be9fd;font-style:italic">main</span> argv <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>    Console.WriteLine <span style="color:#f1fa8c">&#34;Hello World!&#34;</span>
</span></span><span style="display:flex;"><span>    MakeToasts()
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">|&gt;</span> Async.RunSynchronously
</span></span><span style="display:flex;"><span>    Console.WriteLine <span style="color:#f1fa8c">&#34;Bye world!&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#bd93f9">0</span> <span style="color:#6272a4">// return an integer exit code
</span></span></span></code></pre></div><hr>
<p>祝贺你! 你学习了足够的知识，大概可以理解 80% 的 F# 代码了。</p>
<p>或者说 80% 的简单 F# 代码，也就是大多数 F# 脚本中所使用的。</p>
<p>我可以向你解释如何在 F# 中建立相当于类（有行为、构造函数、属性）或结构（值类型和堆栈分配）但是：</p>
<ol>
<li>这些不是 F# 的惯用写法</li>
<li>大多数脚本甚至不需要类型，它们只需要函数、值和调用（如果你把 F# 当脚本用）</li>
</ol>
<p>无论如何，我建议下一步：</p>
<ul>
<li>观看这个 <a href="https://www.youtube.com/watch?v=HQ887aOZITY">讲座</a></li>
<li>看看这篇 <a href="https://www.compositional-it.com/news-blog/5-features-that-c-has-that-f-doesnt-have/">文章</a></li>
</ul>
<p>如果过了一段时间，你还在为从 C# 转换至 F# 而挣扎，也可以时不时地使用这个 <a href="https://github.com/willsam100/FShaper">工具</a>。</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">上次修改於 2022-08-26</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/chip-design/clang-review/">
			下回<br>笨方法学 C 附加题不完全解答
                </a>
                
                
                
                <a class="older-posts" href="/posts/dotnet/advanced-csharp/">
			上回<br>C# 进阶小册 - 并发与异步
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












<script src="https://giscus.app/client.js"
        data-repo="Kyocius/kyocius.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkyODE4MDgxOTA="
        data-category="Announcements"
        data-category-id="DIC_kwDOEMwNPs4CXHLA"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://kyocius.github.io/">
    
        <div class="nav-title">
            游尔曼斯克
        </div>
        
        <div class="nav-subtitle">
            Kyocius &#43;
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                歸檔 Archive
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                分類 Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                標簽 Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about/">
                關於 About
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                訂閱 RSS
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Kyocius. 本站遵循 CC-BY-NC 4.0 协议
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目錄 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%be%8b-1%e5%9f%ba%e6%9c%ac%e5%87%bd%e6%95%b0%e5%a3%b0%e6%98%8e%e4%b8%8e%e5%ae%9e%e7%8e%b0" class="nav-例-1基本函数声明与实现">
									例 1：基本函数声明与实现
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-2%e5%9f%ba%e6%9c%ac%e5%85%b3%e9%94%ae%e5%ad%97%e5%92%8c%e6%93%8d%e4%bd%9c%e7%ac%a6" class="nav-例-2基本关键字和操作符">
									例 2：基本关键字和操作符
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-3%e5%9f%ba%e7%a1%80%e9%9b%86%e5%90%88" class="nav-例-3基础集合">
									例 3：基础集合
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-4%e4%bb%a3%e7%a0%81%e5%9d%97" class="nav-例-4代码块">
									例 4：代码块
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-5%e9%81%bf%e5%85%8d-null-%e5%92%8c%e5%bf%bd%e7%95%a5" class="nav-例-5避免-null-和忽略">
									例 5：避免 Null 和忽略
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-6%e7%b1%bb%e5%9e%8b" class="nav-例-6类型">
									例 6：类型
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-7%e5%87%bd%e6%95%b0%e7%9a%84%e9%a1%ba%e5%ba%8f%e5%be%88%e9%87%8d%e8%a6%81%e5%be%aa%e7%8e%af%e4%be%9d%e8%b5%96%e6%98%af%e4%b8%87%e6%81%b6%e4%b9%8b%e6%ba%90" class="nav-例-7函数的顺序很重要循环依赖是万恶之源">
									例 7：函数的顺序很重要，循环依赖是万恶之源
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-8%e5%a7%94%e6%89%98%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0%e6%88%91%e7%9a%84%e8%80%81%e5%a4%a9%e7%88%b7" class="nav-例-8委托匿名函数我的老天爷">
									例 8：委托、匿名函数···我的老天爷！
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-9%e5%85%83%e7%bb%84%e5%b1%80%e9%83%a8%e5%ba%94%e7%94%a8%e4%bb%a5%e5%8f%8a%e6%9f%af%e9%87%8c%e5%8c%96" class="nav-例-9元组局部应用以及柯里化">
									例 9：元组、局部应用以及柯里化
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-10%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%8f%92%e5%80%bc" class="nav-例-10字符串插值">
									例 10：字符串插值
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-11%e5%bc%82%e6%ad%a5%e4%bb%a3%e7%a0%81" class="nav-例-11异步代码">
									例 11：异步代码
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%be%8b-12%e7%bc%96%e5%86%99%e6%9b%b4%e5%b0%91%e7%ac%a6%e5%8f%b7%e6%8f%90%e5%8d%87-f-%e8%84%9a%e6%9c%ac%e7%9a%84%e5%8f%af%e9%98%85%e8%af%bb%e6%80%a7" class="nav-例-12编写更少符号提升-f-脚本的可阅读性">
									例 12：编写更少符号，提升 F# 脚本的可阅读性！
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Kyocius. 本站遵循 CC-BY-NC 4.0 协议
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
